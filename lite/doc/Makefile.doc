# NLTK-LITE: Tutorial Makefile
#
# Copyright (C) 2001-2005 University of Pennsylvania
# Author: Steven Bird <sb@csse.unimelb.edu.au>
#         Edward Loper <edloper@gradient.cis.upenn.edu>
# URL: <http://nltk.sf.net>
# For license information, see LICENSE.TXT

TUTORIALS = index.txt  preface.txt  introduction.txt  programming.txt  tokenize.txt  tag.txt  parse.txt  chunk.txt  chart.txt  pcfg.txt  field.txt  projects.txt
HTML =      index.html preface.html introduction.html programming.html tokenize.html tag.html parse.html chunk.html chart.html pcfg.html field.html projects.html
PDF =       index.pdf  preface.pdf  introduction.pdf  programming.pdf  tokenize.pdf  tag.pdf  parse.pdf  chunk.pdf  chart.pdf  pcfg.pdf  field.pdf  projects.pdf
ERRS =      index.errs preface.errs introduction.errs programming.errs tokenize.errs tag.errs parse.errs chunk.errs chart.errs pcfg.errs field.errs projects.errs

PYTHON = python
PDFLATEX = pdflatex -halt-on-error
RST2HTML = rst2html.py
RST2LATEX = rst2latex.py --output-encoding=utf-8 --output-encoding-error-handler "backslashreplace" --use-latex-docinfo --font-encoding=T1
FILTER = sed 's/\[utf8\]/[utf8,utf8x]/'

CSS_STYLESHEET_PATH = ../default.css
LATEX_STYLESHEET_PATH = ../definitions.sty

.SUFFIXES: .txt .html .pdf .errs

help: usage
usage:
	@echo "Usage:"
	@echo "    make all         -- Build HTML & PDF output"
	@echo "    make html        -- Build HTML output"
	@echo "    make pdf         -- Build PDF output"
	@echo "    make errs        -- Run doctest to generate .errs files"
	@echo "    make clean       -- Remove all built files"

all: $(HTML) $(PDF) clean_up
html: $(HTML)
pdf: $(PDF)
errs: $(ERRS)
	ls -l $(ERRS)

clean:
	rm -f $(PDF) $(HTML) $(ERRS) *.tex *.log *.aux *.out *.errs

clean_up:
	rm -f *.log *.aux *.tex *.out *.errs

.txt.html:
	$(RST2HTML) --stylesheet-path=$(CSS_STYLESHEET_PATH) $< > $@

.txt.tex:
	$(RST2LATEX) --stylesheet-path=$(LATEX_STYLESHEET_PATH) $< | $(FILTER) > $@

.tex.pdf:
	$(PDFLATEX) $<

.txt.errs:
	$(PYTHON) -c "import doctest; doctest.testfile('$<')" > $@
